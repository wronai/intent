# =============================================================================
# IntentForge Configuration
# Copy to .env and modify for your environment
# =============================================================================
# This is the single source of truth for all environment configuration.
# Used by: Python (pydantic-settings), Docker Compose, and frontend.
# =============================================================================

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
ENVIRONMENT=development
DEBUG=true
LOG_LEVEL=INFO
LOG_FORMAT=json

# Server
APP_HOST=0.0.0.0
APP_PORT=8000
APP_PORT_EXTERNAL=8000
APP_WORKERS=4

# Web/Nginx
WEB_PORT=80

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------
DB_DRIVER=postgresql
DB_HOST=localhost
DB_PORT=5432
DB_PORT_EXTERNAL=5432
DB_NAME=intentforge
DB_USER=postgres
DB_PASSWORD=your_secure_password_here

# Connection pool
DB_POOL_SIZE=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# SSL (optional)
# DB_SSL_MODE=require
# DB_SSL_CA=/path/to/ca.pem

# -----------------------------------------------------------------------------
# MQTT Broker Configuration
# -----------------------------------------------------------------------------
MQTT_HOST=localhost
MQTT_PORT=1883
MQTT_PORT_EXTERNAL=1883
MQTT_WEBSOCKET_PORT=9001
MQTT_WEBSOCKET_PORT_EXTERNAL=9001
# MQTT_USERNAME=
# MQTT_PASSWORD=
MQTT_TOPIC_PREFIX=intentforge
MQTT_QOS=1

# TLS (optional)
# MQTT_USE_TLS=true
# MQTT_CA_CERT=/path/to/ca.crt
# MQTT_CLIENT_CERT=/path/to/client.crt
# MQTT_CLIENT_KEY=/path/to/client.key

# -----------------------------------------------------------------------------
# LLM API Configuration (Anthropic Claude)
# -----------------------------------------------------------------------------
LLM_PROVIDER=anthropic
LLM_API_KEY=sk-ant-your-api-key-here
LLM_MODEL=claude-sonnet-4-5-20250929
LLM_MAX_TOKENS=4096
LLM_TEMPERATURE=0.1

# Rate limiting
LLM_REQUESTS_PER_MINUTE=60
LLM_TOKENS_PER_MINUTE=100000

# Retry settings
LLM_MAX_RETRIES=3
LLM_RETRY_DELAY=1.0

# -----------------------------------------------------------------------------
# Cache Configuration (Redis)
# -----------------------------------------------------------------------------
CACHE_BACKEND=memory  # Options: memory, redis, file
CACHE_DEFAULT_TTL=3600
CACHE_MAX_ENTRIES=10000

# Redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PORT_EXTERNAL=6379
REDIS_URL=redis://localhost:6379/0

# File cache (if CACHE_BACKEND=file)
CACHE_FILE_PATH=/tmp/intentforge_cache

# Fingerprint settings
CACHE_INCLUDE_CONTEXT_IN_FINGERPRINT=true
CACHE_INCLUDE_CONSTRAINTS_IN_FINGERPRINT=true

# -----------------------------------------------------------------------------
# Validation Configuration
# -----------------------------------------------------------------------------
VALIDATION_ENABLE_SYNTAX_CHECK=true
VALIDATION_ENABLE_SECURITY_CHECK=true
VALIDATION_ENABLE_SEMANTIC_CHECK=true

VALIDATION_MAX_CODE_LENGTH=50000
VALIDATION_SANDBOX_TIMEOUT=30
VALIDATION_SANDBOX_MEMORY_LIMIT=256m

# -----------------------------------------------------------------------------
# External Services (Optional)
# -----------------------------------------------------------------------------

# Sentry error tracking
# SENTRY_DSN=https://xxx@sentry.io/xxx

# Metrics (Prometheus/StatsD)
# METRICS_ENABLED=true
# METRICS_PORT=9090

# OpenTelemetry tracing
# OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
# OTEL_SERVICE_NAME=intentforge

# -----------------------------------------------------------------------------
# LLM Providers (Optional)
# -----------------------------------------------------------------------------
# Ollama (local LLM)
OLLAMA_HOST=http://localhost:11434
OLLAMA_PORT=11434
OLLAMA_PORT_EXTERNAL=11434

# LiteLLM Proxy
LITELLM_API_BASE=http://localhost:4000
LITELLM_PORT=4000
LITELLM_PORT_EXTERNAL=4000

# -----------------------------------------------------------------------------
# Development Tools (Optional)
# -----------------------------------------------------------------------------
PGADMIN_PORT=5050
REDIS_COMMANDER_PORT=8081

# -----------------------------------------------------------------------------
# E2E Testing
# -----------------------------------------------------------------------------
TEST_BASE_URL=http://localhost:${WEB_PORT:-80}
TEST_API_URL=http://localhost:${APP_PORT_EXTERNAL:-8000}
HEADLESS=true
